<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- <script src="https://unpkg.com/axios/dist/axios.min.js"></script> -->

</head>
<body>
    <div id="usersDetails">
        <h2>User Details</h2>
        <table id="usersTable">
            <thead id="t_head">
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Father's Name</th>
                    <th>Mother's Name</th>
                    <th>Date-0f-Birth</th>
                    <th>Address</th>
                    <th>Education</th>
                </tr>
            </thead>
            <tbody id="t_body">
                
            </tbody>
            
        </table>
    </div>

    <form id="form" onsubmit="postData(event)">

        <!-- <div class="new_user" > -->
            <div class="form-group">
                <label for="name" class="text-light">Name</label>
                <input type="text" name="name" value="" placeholder="Name" id="username" required>
                <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i>
                <small>Error message</small>
            </div>

            <br>
            <div class="form-group">
                <label for="Email" class="text-light">Email</label>
                <input type="text" name="email" value="" placeholder="example@gmail.com" id="useremail">
                <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i>
                <small>Error message</small>
            </div>
            <br>

            <div class="form-group">
                <label for="motherName" class="text-light">Mother's Name</label>
                <input type="text" name="motherName" value="" placeholder="Mother's Name" id="mothername">
            </div>
            <br>

            <div class="form-group">
                <label for="fatherName" class="text-light">Father's Name</label>
                <input type="text" name="fatherName" value="" placeholder="Father's Name" id="fathername">
            </div>
            <br>

            <div class="form-group">
                <label for="Phone" class="text-light">Phone NO</label>
                <input type="text" name="phone" value="" placeholder="Phone Number" id="phonenumber">
            </div>

            <br>
            <div class="form-group">
                <label for="Date-0f-Birth" class="text-light">Date-of-birth</label>
                <input type="date" name="Date-0f-Birth" value="" placeholder="Date-0f-Birth" id="dateofbirth">
            </div>
            <br>

            <div class="form-group">
                <label for="Address" class="text-light">Country</label>
                <input type="text" name="Address" value="" placeholder="country" id="country">
            </div>
            <br>
            <div class="form-group">
                <label for="city" class="text-light">City</label>
                <input type="text" name="City" value="" placeholder="City" id="city">
            </div>
            <br>
            <div class="form-group">
                <label for="pincode" class="text-light">pincode</label>
                <input type="number" name="pincode" value="" placeholder="pincode" id="pincode">
            </div>
            <br>
            <div class="form-group">
                <label for="state" class="text-light">state</label>
                <input type="text" name="state" value="" placeholder="state" id="state">
            </div>
            <br>
            






            <div class="form-group">
                <label for="matric" class="text-light">Matric marks</label>
                <input type="text" name="matric" value="" placeholder="matric" id="matric">
            </div>
            <br/>

            <div class="form-group">
                <label for="school" class="text-light">School</label>
                <input type="text" name="school" value="" placeholder="school" id="school">
            </div>
            <br/>
            <div class="form-group">
                <label for="yop" class="text-light">Year Of passout</label>
                <input type="number" name="yop" value="" placeholder="yop" id="yop">
            </div>
            <br/>
            
            <div class="form-group">
                <button type="submit" class="btn text-dark update" id="submitButton">Save</button>
            </div>

        <!-- </div> -->
    </form>

    

    
</body>
</html>
<script src="./index.js"></script>

<script>
   const form = document.getElementById('form');
const username = document.getElementById('username');
const useremail = document.getElementById('useremail');
const mothername = document.getElementById('mothername');
const fathername = document.getElementById('fathername');
const phoneno = document.getElementById('phonenumber');
const dob = document.getElementById('dateofbirth');
const address = document.getElementById('address');
const education = document.getElementById('education');

form.addEventListener('submit', e => {
     e.preventDefault();
})

function checkInputs() {
    const usernameValue = username.value.trim()
    const useremailValue =useremail.value.trim()
    const mothernameValue = mothername.value.trim()
    const fathernameValue = fathername.value.trim()
    const phoneValue = phoneno.value.trim();
    const dobValue = dob.value.trim();
    const addressValue = address.value.trim();
    const educationValue = education.value.trim();


    if(usernameValue === "") {
        setErrorFor(username, 'Username cannot be blank');
    } else {
        setSuccessFor(username);
    }

    if(useremailValue === "") {
        setErrorFor(useremail, 'Email cannot be blank');
    } else if(!isEmail(useremailValue)) {
        setErrorFor(useremail, 'Not A valid email')
    } else {
        setSuccessFor(useremail);
    }

}

function setErrorFor(input, message) {
    const formControl= input.parentElement;
    const small = formControl.querySelector('small')
    formControl.className = 'form-group error';
    small.innerText = message;

}
function setSuccessFor(input){
    const formControl = input.parentElement
    formControl.className = 'form-group sucess'
    
}
function isEmail(email) {
	return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email);
}


async function postData(e){

try{
    e.preventDefault()
   var post_data={
name: document.getElementById('username').value,
email: document.getElementById('useremail').value,
mother_name: document.getElementById('mothername').value,
father_name: document.getElementById('fathername').value,
phone : document.getElementById('phonenumber').value,
dob : document.getElementById('dateofbirth').value,
address : {city:document.getElementById('city').value,
            pincode:document.getElementById('pincode').value,
            state:document.getElementById('state').value,
            country:document.getElementById('country').value
},
education : {xth_grade:document.getElementById('matric').value,
            passout_year:document.getElementById('yop').value,
            school:document.getElementById('school').value
}
};
post_data=JSON.stringify(post_data);
console.log('post_data:', post_data)
} catch(err){
     console.log('err:', err)

 }


let reg_api=`http://localhost:3000/users`;

let response= await fetch(reg_api,{
    method: 'POST',

    body: post_data,

    headers: {
        'Content-Type': 'application/json'
    },
});
}
// document.getElementById('submitButton').addEventListener("click", postData())
    


</script>
